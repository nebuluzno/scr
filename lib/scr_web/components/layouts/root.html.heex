<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>SCR - Supervised Cognitive Runtime</title>
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="/assets/app.css"/>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ¤–</text></svg>"/>
  </head>
  <body>
    <div class="aurora-bg" aria-hidden="true"></div>
    <nav class="navbar">
      <div class="nav-container">
        <a href="/" class="nav-brand">
          <span class="brand-icon">â—ˆ</span>
          <span class="brand-text">SCR</span>
        </a>
        <input id="nav-toggle" class="nav-toggle" type="checkbox" />
        <label for="nav-toggle" class="nav-toggle-btn" aria-label="Toggle navigation menu">
          <span></span>
          <span></span>
          <span></span>
        </label>
        <button type="button" id="density-toggle" class="density-toggle" aria-label="Toggle compact density">
          Compact
        </button>
        <ul class="nav-links" id="nav-menu">
          <li><a href="/">Dashboard</a></li>
          <li><a href="/agents">Agents</a></li>
          <li><a href="/tasks/new">New Task</a></li>
          <li><a href="/tools">Tools</a></li>
          <li><a href="/memory">Memory</a></li>
          <li><a href="/metrics">Metrics</a></li>
        </ul>
      </div>
    </nav>

    <main class="main-content">
      <%= @inner_content %>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <p>Supervised Cognitive Runtime v0.5.0-alpha</p>
      </div>
    </footer>
    <script>
      (() => {
        const storageKey = "scr.ui.density";

        const applyDensity = (density) => {
          const normalized = density === "compact" ? "compact" : "comfortable";
          document.body.dataset.density = normalized;
          const btn = document.getElementById("density-toggle");

          if (btn) {
            btn.textContent = normalized === "compact" ? "Comfortable" : "Compact";
            btn.setAttribute("aria-pressed", normalized === "compact" ? "true" : "false");
          }
        };

        const loadDensity = () => localStorage.getItem(storageKey) || "comfortable";

        document.addEventListener("DOMContentLoaded", () => {
          applyDensity(loadDensity());

          const btn = document.getElementById("density-toggle");

          if (btn) {
            btn.addEventListener("click", () => {
              const nextDensity = document.body.dataset.density === "compact" ? "comfortable" : "compact";
              localStorage.setItem(storageKey, nextDensity);
              applyDensity(nextDensity);
            });
          }
        });
      })();
    </script>
  </body>
</html>
